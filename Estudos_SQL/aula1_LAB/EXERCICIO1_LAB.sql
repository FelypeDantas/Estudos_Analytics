CREATE DATABASE CURSO;
GO
USE CURSO;

CREATE TABLE TB_ESTADO(
	SIGLA_ESTADO	CHAR(2)		PRIMARY KEY,
	NOME_ESTADO		VARCHAR(40)
);
GO
CREATE TABLE TB_CLASSE(
	ID_CLASSE			SMALLINT	PRIMARY KEY,
	ID_ANDAR			SMALLINT
);
GO
CREATE TABLE TB_PROFESSOR(
	ID_PROFESSOR		CHAR(3)		PRIMARY KEY,
	NOME_PROFESSOR		VARCHAR(25)
);
GO
CREATE TABLE TB_DISCIPLINA(
	ID_DISCIPLINA		CHAR(3)		PRIMARY KEY,
	NOME_DISCIPLINA		VARCHAR(15),
	ID_PROFESSOR_DISCIPLINA	CHAR(3),
	NOTA_MINIMA_DISCIPLINA	SMALLINT
	FOREIGN KEY (ID_PROFESSOR_DISCIPLINA) REFERENCES TB_PROFESSOR(ID_PROFESSOR)
);
GO
CREATE TABLE TB_ALUNO(
	COD_ALUNO		SMALLINT		PRIMARY KEY,
	NOME_ALUNO		VARCHAR(45),
	END_ALUNO		VARCHAR(100),
	SIGLA_ESTADO	CHAR(2),
	ID_CLASSE		SMALLINT
	FOREIGN KEY (SIGLA_ESTADO) REFERENCES TB_ESTADO(SIGLA_ESTADO),
	FOREIGN KEY (ID_CLASSE) REFERENCES TB_CLASSE(ID_CLASSE)
);
GO
CREATE TABLE TB_ALUNO_DISCIPLINA(
	COD_ALUNO		SMALLINT,
	ID_DISCIPLINA	CHAR(3),
	NOTA_ALUNO		SMALLINT
	PRIMARY KEY (COD_ALUNO, ID_DISCIPLINA),
	FOREIGN KEY (ID_DISCIPLINA) REFERENCES TB_DISCIPLINA(ID_DISCIPLINA),
	FOREIGN KEY (COD_ALUNO) REFERENCES TB_ALUNO(COD_ALUNO)
);

INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('JOI', 'JOILSON CARDOSO');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('OSE', 'OSEAS SANTANA');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('VIT', 'VITOR VASCONCELOS');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('FER', 'JOSE ROBERTO FERROLI');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('LIM', 'VALMIR LIMA');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('EDS', 'EDSON SILVA');
INSERT INTO TB_PROFESSOR(ID_PROFESSOR, NOME_PROFESSOR) VALUES ('WAG', 'WAGNER OKIDA');

INSERT INTO TB_ESTADO (SIGLA_ESTADO, NOME_ESTADO) VALUES ('SP', 'São Paulo');

INSERT INTO TB_CLASSE (ID_CLASSE, ID_ANDAR) VALUES (1, 1);
INSERT INTO TB_CLASSE (ID_CLASSE, ID_ANDAR) VALUES (2, 1);
INSERT INTO TB_CLASSE (ID_CLASSE, ID_ANDAR) VALUES (3, 2);


INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (1, 'ANTONIO CARLOS PENTEADO', 'RUA X', 'SP', 1);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (2, 'AUROMIR DA SILVA VALDEVINO', 'RUA W','SP',1);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (3, 'ANDRE COSTA', 'RUA T', 'SP', 1);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (4, 'ROBERTO SOARES DE MENEZES', 'RUA BW', 'SP', 2);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (5, 'DANIA', 'RUA CCC', 'SP', 2);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (6, 'CARLOS MAGALHAES', 'AV SP', 'SP', 2);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (7, 'MARCELO RAUBA', 'AV SAO LUIS', 'SP', 3);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (8, 'FERNANDO', 'AV COUNTYR', 'SP', 3);
INSERT INTO TB_ALUNO(COD_ALUNO, NOME_ALUNO, END_ALUNO, SIGLA_ESTADO, ID_CLASSE) VALUES (9, 'WALMIR BURIN', 'RUA SSISIS', 'SP', 3);

INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('MAT', 'MATEMATICA', 'JOI', 7);
INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('POR', 'PORTUGUES', 'VIT', 5);
INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('FIS','FISICA', 'OSE', 3);
INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('HIS', 'HISTORIA', 'EDS', 2);
INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('GEO', 'GEOGRAFIA', 'WAG', 4);
INSERT INTO TB_DISCIPLINA(ID_DISCIPLINA, NOME_DISCIPLINA, ID_PROFESSOR_DISCIPLINA, NOTA_MINIMA_DISCIPLINA) VALUES ('ING', 'INGLES', 'LIM', 2);

INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (1, 'MAT', 0);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (2, 'MAT', 0);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (3, 'MAT', 1);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (4, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (5, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (6, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (7, 'FIS', 3);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (8, 'FIS', 3);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (9, 'FIS', 3);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (1, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (2, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (7, 'POR', 2);
INSERT INTO TB_ALUNO_DISCIPLINA(COD_ALUNO, ID_DISCIPLINA, NOTA_ALUNO) VALUES (1, 'FIS', 3);

SELECT * FROM TB_ALUNO;

SELECT NOME_DISCIPLINA FROM TB_DISCIPLINA
WHERE NOTA_MINIMA_DISCIPLINA > 5;

SELECT NOME_DISCIPLINA FROM TB_DISCIPLINA
WHERE NOTA_MINIMA_DISCIPLINA >= 3 AND NOTA_MINIMA_DISCIPLINA <= 5;

SELECT COD_ALUNO, NOME_ALUNO, ID_CLASSE FROM TB_ALUNO
ORDER BY NOME_ALUNO;

SELECT COD_ALUNO, NOME_ALUNO, ID_CLASSE FROM TB_ALUNO
ORDER BY NOME_ALUNO DESC;

SELECT COD_ALUNO FROM TB_ALUNO_DISCIPLINA
WHERE ID_DISCIPLINA = 'MAT' AND COD_ALUNO IN(
	SELECT COD_ALUNO FROM TB_ALUNO_DISCIPLINA
	WHERE ID_DISCIPLINA = 'POR'
);